---
title: TeX 入門
date: '2024-09-04'
tags: ['TeX']
summary: 
---

## TeX

### Hello, TeX!

まずは, Hello, world! ならぬ Hello, TeX! をする. TeX における標準入出力を行うためのマクロを以下のように定義する.

```tex:stdio.tex
\def \ReadStdin(#1){
  {
    \endlinechar = -1
    \global\read 0 to #1
  }
}

\def \WriteStdout(#1){
  \immediate\write 0 {#1}
}
```

以降では, 上記のファイルを読み込んで `\ReadStdin`, `\WriteStdout` を使用する.

Hello, TeX! をするには以下のように記述する.

```tex:hello.tex
\input{stdio}
\ReadStdin(\Name)
\WriteStdout(Hello, \Name!)
\bye
```

続いて, 以下のように実行する[^1]. なお, 本記事では LuaTeX を使用する.  

```txt
$ luatex --halt-on-error hello.tex 
This is LuaTeX, Version 1.15.0 (TeX Live 2022) 
 restricted system commands enabled.
(./hello.tex (./stdio.tex)
\Name =TeX
Hello, TeX!
)
warning  (pdf backend): no pages of output.
Transcript written on hello.log.

```

上記の実行結果より, 標準入力として `\Name =` が求められ, `TeX` と入力すると, 標準出力で `Hello, TeX!` が出力されていることが分かる.

<details>
<summary>単なる Hello, world! の場合</summary>

```julia:hello.jl
\input{stdio}
\WriteStdout(Hello, world!)
\bye
```

**実行結果**
```txt
luatex --halt-on-error hello.tex
This is LuaTeX, Version 1.15.0 (TeX Live 2022) 
 restricted system commands enabled.
(./hello.tex (./stdio.tex)
Hello, world!
)
warning  (pdf backend): no pages of output.
Transcript written on hello.log.

```
</details>

### プロセッサ構成

TeX の処理系は以下の4つのプロセッサから構成されている.

- 入力プロセッサ
 - ソースコードの文字列からトークン列を作る.
- 展開プロセッサ
 - トークン列を必要に応じて展開し, 展開後のトークン列にする.
- 実行プロセッサ
 - 展開後のトークン列を実行し, 処理系の内部状態を変更したり組版のボックスリストを作る.
- 出力プロセッサ
 - 組版のボックスリストからページを出力する.

### トークンの種類

- 文字トークン
 - `a`, `1`, `@` 等.
- 制御トークン
 - `\` から始まる文字列 (`\let`, `\relax` 等).

なお, 制御トークンは, 展開されるトークンと展開されないトークン, `\let` で代入されたトークンに大別される. 

**展開されるトークン**

|トークンの種類|例|
|---|---|
|マクロ|`\def` 等で定義されたトークン|
|条件分岐|`\if`, `\ifnum`, `\fi` 等|
|展開制御|`\expandafter`, `\noexpand` 等|
|組込みの変換|`\number`, `\string` 等|

**展開されないトークン**

|トークンの種類|例|
|---|---|
|整数変数|`\newcount` 等で定義されたトークン|
|整数演算|`\advance`, `\multiply` 等|
|定義|`\def`, `\let` 等|
|何もしない命令|`\relax`|
|組版用の命令||


[^1]: `--halt-on-error` オプションは, エラー発生時に処理系の実行を終了させるために指定している.